<template>
    <map-dropdown>
        <map-context-menu>
            <button class={computedClass}
                onclick={handleClick}>
                <template for:each={tile.layers} for:item="layer">
                    <img key={layer.id} src={layer.src}></img>
                </template>
                <template if:true={tile.comment}>
                    <svg class="comment" viewBox="0 0 24 24">
                        <path d="M 24,2.86102e-005L 24,20C 24,21.6569 22.6569,23 21,23C 20.1716,23 19.4216,22.6642 18.8787,22.1213L 1.87867,5.12132C 1.33578,4.57843 1,3.82842 1,3C 1,1.34315 2.34315,0 4,0L 4.01379,2.86102e-005L 24,2.86102e-005 Z "></path>
                    </svg>
                </template>
                <span>{hash}</span>
            </button>
            <map-menu slot="menu">
                <map-menu-item onclick={handleEditComment}>
                    <map-icon slot="left" path={mdiPencil}></map-icon>
                    Edit Comment
                </map-menu-item>
                <map-menu-item if:true={tile.comment} onclick={handleComment}>
                    <map-icon slot="left" path={mdiCommentRemove}></map-icon>
                    Delete Comment
                </map-menu-item>
                <map-menu-separator></map-menu-separator>
                <map-menu-item onclick={handleDelete}>
                    <map-icon slot="left" path={mdiDelete}></map-icon>
                    Delete
                </map-menu-item>
            </map-menu>
        </map-context-menu>
        <map-menu slot="menu">
            <div style="padding:0.5rem 0.5rem 0.25rem 0.5rem">
                <map-button-group block>
                    <map-button active={insideActive} onclick={handleToggleInside}>Inside</map-button>
                    <map-button active={outsideActive} onclick={handleToggleOutside}>Outside</map-button>
                </map-button-group>
            </div>
            <div if:true={insideActive} class="wall">
                <div>
                    <button onclick={tileWallHandler} data-wall="9">
                        <img src="resources/tiles/wall-9.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="1">
                        <img src="resources/tiles/wall-1.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="3">
                        <img src="resources/tiles/wall-3.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="11">
                        <img src="resources/tiles/wall-11.svg"></img>
                    </button>
                </div>
                <div>
                    <button onclick={tileWallHandler} data-wall="8">
                        <img src="resources/tiles/wall-8.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="0">
                        <img src="resources/tiles/wall-0.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="2">
                        <img src="resources/tiles/wall-2.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="10">
                        <img src="resources/tiles/wall-10.svg"></img>
                    </button>
                </div>
                <div>
                    <button onclick={tileWallHandler} data-wall="12">
                        <img src="resources/tiles/wall-12.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="4">
                        <img src="resources/tiles/wall-4.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="6">
                        <img src="resources/tiles/wall-6.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="14">
                        <img src="resources/tiles/wall-14.svg"></img>
                    </button>
                </div>
                <div>
                    <button onclick={tileWallHandler} data-wall="13">
                        <img src="resources/tiles/wall-13.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="5">
                        <img src="resources/tiles/wall-5.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="7">
                        <img src="resources/tiles/wall-7.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="15">
                        <img src="resources/tiles/wall-15.svg"></img>
                    </button>
                </div>
            </div>
            <div if:true={outsideActive} class="wall">
                <div>
                    <button onclick={tileWallHandler} data-wall="9">
                        <img src="resources/tiles/wall-outside-9.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="1">
                        <img src="resources/tiles/wall-outside-1.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="3">
                        <img src="resources/tiles/wall-outside-3.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="11">
                        <img src="resources/tiles/wall-outside-11.svg"></img>
                    </button>
                </div>
                <div>
                    <button onclick={tileWallHandler} data-wall="8">
                        <img src="resources/tiles/wall-outside-8.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="0">
                        <img src="resources/tiles/wall-outside-0.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="2">
                        <img src="resources/tiles/wall-outside-2.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="10">
                        <img src="resources/tiles/wall-outside-10.svg"></img>
                    </button>
                </div>
                <div>
                    <button onclick={tileWallHandler} data-wall="12">
                        <img src="resources/tiles/wall-outside-12.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="4">
                        <img src="resources/tiles/wall-outside-4.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="6">
                        <img src="resources/tiles/wall-outside-6.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="14">
                        <img src="resources/tiles/wall-outside-14.svg"></img>
                    </button>
                </div>
                <div>
                    <button onclick={tileWallHandler} data-wall="13">
                        <img src="resources/tiles/wall-outside-13.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="5">
                        <img src="resources/tiles/wall-outside-5.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="7">
                        <img src="resources/tiles/wall-outside-7.svg"></img>
                    </button>
                    <button onclick={tileWallHandler} data-wall="15">
                        <img src="resources/tiles/wall-outside-15.svg"></img>
                    </button>
                </div>
            </div>
        </map-menu>
    </map-dropdown>
    <map-modal if:true={openDeleteComment}>
        <map-modal-body>
            <p>Are you sure you want to clear the comment?</p>
        </map-modal-body>
        <map-modal-footer>
            <map-button onclick={cancelDeleteComment}>Cancel</map-button>
            <map-button onclick={confirmDeleteComment} variant="primary">Delete</map-button>
        </map-modal-footer>
    </map-modal>
    <map-modal if:true={modalOpen} width="80%">
        <map-form onchange={updateComment} onsubmit={submitComment}>
            <map-modal-body>
                <map-textarea focus name="comment" value={tile.comment}></map-textarea>
            </map-modal-body>
            <map-modal-footer>
                <map-button submit variant="primary">Update</map-button>
            </map-modal-footer>
        </map-form>
    </map-modal>
</template>
